<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Sistema de Solicita√ß√£o de Pe√ßas - Manuten√ß√£o Matapi</title>
   <style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background-color: #FFFFFF;
        min-height: 100vh;
        padding: 20px;
    }

    .container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        border-radius: 15px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        overflow: hidden;
    }

    .header {
        background-color: #005D9F;
        color: white;
        padding: 30px;
        text-align: center;
    }

    .header h1 {
        font-size: 2.5em;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }

    .header p {
        font-size: 1.2em;
        opacity: 0.9;
    }

    .main-content {
        padding: 40px;
    }

    .section {
        margin-bottom: 40px;
        padding: 30px;
        border: 2px solid #e0e0e0;
        border-radius: 10px;
        background: #f8f9fa;
    }

    .section h2 {
        color: #2c3e50;
        margin-bottom: 25px;
        font-size: 1.8em;
        border-bottom: 3px solid #3498db;
        padding-bottom: 10px;
    }

    .form-group {
        margin-bottom: 10px;
    }

    .form-row {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, -1fr));
        gap: 10px;
        margin-bottom: 1px;
    }

    label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: #2c3e50;
    }

    /* Ajuste dos inputs */
    input,
    select,
    textarea {
        width: 100%;
        max-width: 400px;
        padding: 12px;
        border: 2px solid #ddd;
        border-radius: 8px;
        font-size: 16px;
        transition: all 0.3s ease;
        height: auto;
    }

    input:focus,
    select:focus,
    textarea:focus {
        outline: none;
        border-color: #3498db;
        box-shadow: 0 0 10px rgba(52, 152, 219, 0.3);
    }

    /* Tamanhos proporcionais */
    input.short {
        max-width: 120px;
        text-align: center;
    }

    input.medium,
    select.medium {
        max-width: 250px;
    }

    input.long,
    textarea.long {
        max-width: 600px;
    }

    .btn {
        background: linear-gradient(135deg, #3498db, #2980b9);
        color: white;
        padding: 12px 25px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 16px;
        font-weight: 600;
        transition: all 0.3s ease;
        margin: 5px;
    }

    .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    .btn-success {
        background: linear-gradient(135deg, #27ae60, #229954);
    }

    .btn-danger {
        background: linear-gradient(135deg, #e74c3c, #c0392b);
    }

    .btn-warning {
        background: linear-gradient(135deg, #f39c12, #e67e22);
    }

    .item-card {
        background: white;
        border: 2px solid #e0e0e0;
        border-radius: 10px;
        padding: 20px;
        margin-bottom: 20px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    .item-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
        padding-bottom: 10px;
        border-bottom: 2px solid #ecf0f1;
    }

    .item-number {
        background: #3498db;
        color: white;
        padding: 5px 15px;
        border-radius: 20px;
        font-weight: bold;
    }

    .image-preview {
        max-width: 200px;
        max-height: 200px;
        border-radius: 8px;
        margin-top: 10px;
        border: 2px solid #ddd;
    }

    .image-options {
        display: flex;
        gap: 10px;
        margin-bottom: 10px;
    }

    .image-option {
        padding: 8px 16px;
        border: 2px solid #ddd;
        border-radius: 5px;
        cursor: pointer;
        background: white;
        transition: all 0.3s ease;
        user-select: none;
    }

    .image-option.active {
        border-color: #3498db;
        background: #e3f2fd;
    }

    .paste-area {
        border: 2px dashed #ddd;
        border-radius: 8px;
        padding: 40px;
        text-align: center;
        background: #f9f9f9;
        cursor: pointer;
        transition: all 0.3s ease;
        outline: none;
    }

    .paste-area:hover {
        border-color: #3498db;
        background: #e3f2fd;
    }

    .paste-area.dragover {
        border-color: #27ae60;
        background: #d4edda;
    }

    /* Relat√≥rio Simplificado */
    .report {
        background: white;
        padding: 30px;
        margin: 0;
        font-family: Arial, sans-serif;
        line-height: 1.4;
    }

    .report-header {
        text-align: center;
        margin-bottom: 30px;
        border-bottom: 2px solid #333;
        padding-bottom: 15px;
    }

    .report-title {
        font-size: 24px;
        font-weight: bold;
        color: #2c3e50;
        margin-bottom: 5px;
    }

    .report-subtitle {
        font-size: 18px;
        color: #34495e;
    }

    .report-info {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 30px;
    }

    .info-section {
        border: 1px solid #ddd;
        padding: 15px;
        border-radius: 5px;
    }

    .info-section h3 {
        font-size: 16px;
        margin-bottom: 10px;
        color: #2c3e50;
        border-bottom: 1px solid #eee;
        padding-bottom: 5px;
    }

    .info-line {
        margin-bottom: 5px;
        font-size: 14px;
    }

    .info-label {
        font-weight: bold;
        display: inline-block;
        width: 80px;
    }

    .items-simple-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
        font-size: 14px;
    }

    .items-simple-table th,
    .items-simple-table td {
        padding: 8px;
        text-align: left;
        border: 1px solid #ddd;
        vertical-align: top;
    }

    .items-simple-table th {
        background: #f5f5f5;
        font-weight: bold;
    }

    .items-simple-table img {
        max-width: 80px;
        max-height: 80px;
        object-fit: cover;
        border-radius: 3px;
    }

    @media print {
        body {
            background: white;
            padding: 0;
        }
        .btn {
            display: none;
        }
        .container {
            box-shadow: none;
            border-radius: 0;
        }
        .search-box {
            display: none;
        }
        .report {
            padding: 20px;
        }
    }

    .hidden {
        display: none;
    }

    .alert {
        padding: 15px;
        margin-bottom: 20px;
        border-radius: 8px;
        font-weight: bold;
    }

    .alert-error {
        background: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
    }

    .alert-success {
        background: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
    }

    .search-box {
        margin-bottom: 10px;
    }

    .search-box input {
        padding: 8px;
        font-size: 14px;
    }
    
    input {
        text-transform: uppercase;
    }
</style>

</head>
<body>
    <div class="container">
        <div class="header">
            <h1>MANUTEN√á√ÉO MATAPI</h1>
            <p>SOLICITA√á√ÉO DE PE√áAS E ACESS√ìRIOS PARA VIATURAS E EQUIPAMENTOS</p>
        </div>

        <div class="main-content">
            <!-- Se√ß√£o de Dados do Solicitante -->
            <div class="section">
                <h2>Dados do Solicitante</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label for="solicitante">Solicitante: *</label>
                        <input type="text" id="solicitante" placeholder="Nome de Guerra" />
                    </div>
                    <div class="form-group">
                        <label for="dataSolicitacao">Data da Solicita√ß√£o:</label>
                        <input type="date" id="dataSolicitacao" />
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o de Sele√ß√£o de Ve√≠culo -->
            <div class="section">
                <h2>Dados da Viatura/Equipamento</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label for="prefixo">Prefixo:</label>
                        <div class="search-box">
                            <input
                                type="text"
                                id="searchPrefixo"
                                placeholder="Digite para buscar..."
                                onkeyup="filtrarPrefixos()"
                                autocomplete="off"
                            />
                        </div>
                        <select id="prefixo" onchange="carregarDadosVeiculo()" size="5">
                            <option value="">Selecione o Prefixo</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="marca">Fabricante:</label>
                        <input type="text" id="marca" readonly />
                    </div>
                    <div class="form-group">
                        <label for="modelo">Modelo:</label>
                        <input type="text" id="modelo" readonly />
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="ano">Ano:</label>
                        <input type="text" id="ano" readonly />
                    </div>
                    <div class="form-group">
                        <label for="chassi">Chassi/N¬∫ S√©rie:</label>
                        <input type="text" id="chassi" readonly />
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o de Cadastro de Itens -->
            <div class="section">
                <h2>Cadastro de Itens Solicitados</h2>
                <div id="alertContainer"></div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="referencia">Refer√™ncia: *</label>
                        <input type="text" id="referencia" placeholder="Ex: ABC123, REF456" />
                    </div>
                    <div class="form-group">
                        <label for="descricao">Descri√ß√£o: *</label>
                        <input type="text" id="descricao" placeholder="Descri√ß√£o detalhada da pe√ßa" />
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="quantidade">Quantidade: *</label>
                        <input type="number" id="quantidade" min="1" value="1" />
                    </div>
                    <div class="form-group">
                        <label for="unidade">Unidade de Medida:</label>
                        <select id="unidade">
                            <option value="UND">UND</option>
                            <option value="KIT">KIT</option>
                            <option value="CONJUNTO">CONJUNTO</option>
                            <option value="KILO">KILO</option>
                            <option value="LITRO">LITRO</option>
                            <option value="TAMBOR">TAMBOR</option>
                            <option value="GAL√ÉO">GAL√ÉO</option>
                            <option value="BALDE">BALDE</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="link">Link de Refer√™ncia:</label>
                    <input type="url" id="link" placeholder="https://exemplo.com/peca" />
                </div>

                <div class="form-group">
                    <label>Imagem da Pe√ßa:</label>
                    <div class="image-options">
                        <div class="image-option active" onclick="alternarOpcaoImagem('colar', event)">üìã Colar Imagem</div>
                        <div class="image-option" onclick="alternarOpcaoImagem('arquivo', event)">üìÅ Anexar Arquivo</div>
                    </div>

                    <div id="pasteArea" class="paste-area" tabindex="0">
                        <p>üìã Clique aqui e pressione Ctrl+V para colar uma imagem</p>
                        <small>Ou arraste e solte uma imagem aqui</small>
                    </div>

                    <input type="file" id="imagem" accept="image/*" onchange="previewImagem()" class="hidden" />

                    <img
                        id="imagemPreview"
                        class="image-preview hidden"
                        alt="Preview da imagem da pe√ßa selecionada"
                        src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/cafca747-6c9d-475b-ade3-4214a2828882.png"
                    />
                </div>

                <button class="btn btn-success" onclick="adicionarItem()">Adicionar Item</button>
            </div>

            <!-- Lista de Itens Adicionados -->
            <div class="section">
                <h2>Itens Solicitados</h2>
                <div id="listaItens">
                    <p style="text-align: center; color: #7f8c8d; font-style: italic;">Nenhum item adicionado ainda.</p>
                </div>
            </div>

            <!-- Bot√µes de A√ß√£o -->
                <div style="text-align: center; margin-top: 30px;">
                <button class="btn btn-warning" onclick="gerarRelatorio()">üìÑ Gerar Relat√≥rio</button>
                <button class="btn btn-danger" onclick="limparFormulario()">üóëÔ∏è Limpar Tudo</button>
            </div>
        </div>

<!-- Relat√≥rio Simplificado -->
<div id="relatorio" class="hidden">
  <div class="report">
    <div class="report-info">
      <div class="info-section">
        <h3>Dados do Solicitante</h3>
        <div class="info-line">
          <span class="info-label">Nome:</span>
          <span id="relSolicitante">-</span>
        </div>
        <div class="info-line">
          <span class="info-label">Data:</span>
          <span id="relDataSolicitacao">-</span>
        </div>
      </div>

      <div class="info-section">
        <h3>Dados da Viatura/Equipamento</h3>
        <div class="info-line">
          <span class="info-label">Prefixo:</span>
          <span id="relPrefixo">-</span>
        </div>
        <div class="info-line">
          <span class="info-label">Fabricante:</span>
          <span id="relMarca">-</span>
        </div>
        <div class="info-line">
          <span class="info-label">Modelo:</span>
          <span id="relModelo">-</span>
        </div>
        <div class="info-line">
          <span class="info-label">Ano:</span>
          <span id="relAno">-</span>
        </div>
        <div class="info-line">
          <span class="info-label">Chassi:</span>
          <span id="relChassi">-</span>
        </div>
      </div>
    </div>

    <div>
      <h3>Itens Solicitados</h3>
      <table class="items-simple-table" style="width: 100%; border-collapse: collapse;">
        <thead>
          <tr>
            <th style="width: 5%; border: 1px solid #ddd; padding: 8px;">Item</th>
            <th style="width: 10%; border: 1px solid #ddd; padding: 8px;">Qtd.</th>
            <th style="width: 10%; border: 1px solid #ddd; padding: 8px;">Unid.</th>
            <th style="width: 15%; border: 1px solid #ddd; padding: 8px;">Refer√™ncia</th>
            <th style="width: 35%; border: 1px solid #ddd; padding: 8px;">Descri√ß√£o</th>
            <th style="width: 20%; border: 1px solid #ddd; padding: 8px;">Link</th>
            <th style="width: 15%; border: 1px solid #ddd; padding: 8px;">Imagem</th>
          </tr>
        </thead>
        <tbody id="tabelaItensSimples"></tbody>
      </table>
    </div>

    
    <!-- Bibliotecas para gerar PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    

    <div style="text-align: center; margin-top: 30px;">
      <button class="btn" onclick="imprimirRelatorio()">üì• Gerar PDF</button>
      <button class="btn btn-danger" onclick="voltarFormulario()">üîô Voltar</button>
    </div>
  </div>
</div>

    <script>
        // Base de dados dos ve√≠culos/equipamentos
        const veiculos = {
            "AM-00064": { chassi: "93YMAF4MEEJ634527", fabricante: "RENAULT", modelo: "MASTER FURG√ÉO UTI", ano: "2012" },
            "AM-00088": { chassi: "9BFLF49P8HB011899", fabricante: "FORD", modelo: "F4000", ano: "2017" },
            "C√ÇMARA FRIGOR√çFICA": { chassi: "9A9FR3883ECDB5485", fabricante: "NIJU", modelo: "NJSRFR 3E", ano: "2012" },
            "CB-00566": { chassi: "9BFZEANE4JBS68029 1034799", fabricante: "FORD", modelo: "2629", ano: "2017" },
            "CB-00569": { chassi: "9BFZEANE2JBS68031", fabricante: "FORD", modelo: "2629", ano: "2017" },
            "CB-00593": { chassi: "9BM6933865B428451", fabricante: "MERCEDES BENZ", modelo: "2423K", ano: "2005" },
            "CB-00685": { chassi: "9BM958170NB281372", fabricante: "MERCEDES BENZ", modelo: "ATEGO 2730", ano: "2022" },
            "CB-00686": { chassi: "9BM958170NB281400", fabricante: "MERCEDES BENZ", modelo: "ATEGO 2730", ano: "2022" },
            "CB-00687": { chassi: "9BM958170NB280581", fabricante: "MERCEDES BENZ", modelo: "ATEGO 2730", ano: "2022" },
            "CB-00688": { chassi: "9BM958170NB280693", fabricante: "MERCEDES BENZ", modelo: "ATEGO 2730", ano: "2022" },
            "CB-00689": { chassi: "9BM958170NB281107", fabricante: "MERCEDES BENZ", modelo: "ATEGO 2730", ano: "2022" },
            "CB-NC-SGA-CB-CHASSI-96776": { chassi: "93KKZ60D2RE196776", fabricante: "VOLVO", modelo: "VM 360 6X4 R", ano: "2024" },
            "CC-00751": { chassi: "9BM958034CB877619", fabricante: "MERCEDES BENZ", modelo: "ATEGO 1418/48 9TON 4X2", ano: "2012" },
            "CDA-00046": { chassi: "9BM958074EB949227", fabricante: "MERCEDES BENZ", modelo: "ATEGO 1719", ano: "2014" },
            "CDA-00063": { chassi: "9BFYEALE8KBS73458", fabricante: "FORD", modelo: "CARGO 2429", ano: "2018" },
            "CG-00068": { chassi: "9BM958174JB087409", fabricante: "MERCEDES BENZ", modelo: "2730/48", ano: "2018" },
            "CL-00056": { chassi: "9BFYCE7V2ABB56838", fabricante: "FORD", modelo: "CARGO 1722 √â", ano: "2010" },
            "CL-00071": { chassi: "9BFZEANE3DBS23054", fabricante: "FORD", modelo: "CARGO 2629", ano: "2012" },
            "CM-00114": { chassi: "9BM958461AB730093", fabricante: "MERCEDES BENZ", modelo: "AXOR 2540", ano: "2010" },
            "CM-00116": { chassi: "9BM958453KB118549 457910V1033488", fabricante: "MERCEDES BENZ", modelo: "AXOR TETO ALTO 2644 6X4S", ano: "2019" },
            "CM-00117": { chassi: "9BSR6X400E3862856", fabricante: "SCANIA", modelo: "R480/R124", ano: "2014" },
            "CO-00021": { chassi: "9BFYCE7V4ABB56193", fabricante: "FORD", modelo: "CARGO 1722 √â", ano: "2010" },
            "CO-00043": { chassi: "9BM6931825B423554", fabricante: "MERCEDES BENZ", modelo: "1720", ano: "2005" },
            "CPD-00380": { chassi: "93XLJKL1TJCJ07238", fabricante: "MITSUBISHI", modelo: "TRITON-L200 SPT GL 2.4", ano: "2018" },
            "CQT-00132": { chassi: "N/A", fabricante: "VOLKSWAGEN", modelo: "WORKER EURO 4X4", ano: "2013" },
            "CQT-00133": { chassi: "9533172S8DR342505", fabricante: "VOLKSWAGEN", modelo: "WORKER EURO 4X4", ano: "2013" },
            "CQT-00135": { chassi: "9533172S2ER402671", fabricante: "VOLKSWAGEN", modelo: "WORKER EURO 4X4", ano: "2013" },
            "CQT-00137": { chassi: "9533172S7DR319183", fabricante: "VOLKSWAGEN", modelo: "WORKER EURO 4X4", ano: "2013" },
            "CQT-00138": { chassi: "9533172S3DR331556", fabricante: "VOLKSWAGEN", modelo: "WORKER EURO 4X4", ano: "2013" },
            "CQT-00261": { chassi: "9533172S9DR319279", fabricante: "VOLKSWAGEN", modelo: "WORKER EURO 4X4", ano: "2013" },
            "CTA-00100": { chassi: "9BFZCE9V6ABB53372", fabricante: "FORD", modelo: "2622E", ano: "2010" },
            "CTA-00120": { chassi: "9533B82U5DR312401", fabricante: "VOLKSWAGEN", modelo: "WORKER 26 260 √â", ano: "2012" },
            "CTA-00134": { chassi: "9533882U9DR319710", fabricante: "VOLKSWAGEN", modelo: "WORKER 26 260 √â", ano: "2013" },
            "CTA-00138": { chassi: "9533B8Z9DUR318735", fabricante: "VOLKSWAGEN", modelo: "WORKER 26 260 √â", ano: "2013" },
            "CTA-00177": { chassi: "93ZE12NMZJ8932865", fabricante: "IVECO", modelo: "TECTOR 260E30", ano: "2017" },
            "CTC-00046": { chassi: "9BFZEANE2DBS30125", fabricante: "FORD", modelo: "2629", ano: "2011" },
            "ONR-00079": { chassi: "9532882W5CR208047", fabricante: "VOLKSWAGEN", modelo: "SENIOR MIDI 15190", ano: "2012" },
            "ONR-00077": { chassi: "9532J82Z4DR334433", fabricante: "VOLKSWAGEN", modelo: "18.320 EOT", ano: "2013" },
            "ONU-00037": { chassi: "9532G82W4JR807599", fabricante: "VOLKSWAGEN", modelo: "17,230 GRAN VIA", ano: "2017" },
            "PA-00003": { chassi: "9A9PR45638LDJ5016", fabricante: "LIBRELATO", modelo: "SRPR3E", ano: "2007" },
            "PB-00052": { chassi: "9A9P1463EECEM5027", fabricante: "MORUMBI", modelo: "SP,PR,3EX", ano: "2014" },
            "PB-00069": { chassi: "9A9P1604DDCEM5168", fabricante: "MORUMBI", modelo: "PLATAFORMA", ano: "2013" },
            "VTE-00003": { chassi: "9533B82U9HR703184", fabricante: "VOLKSWAGEN", modelo: "26 260", ano: "2016" },
            "AB-00007": { chassi: "BX14M05009 MOTOR: B521497B", fabricante: "FIORI", modelo: "DB X35", ano: "2018" },
            "CA-00080": { chassi: "625366700016", fabricante: "MOTOMIL", modelo: "CMAV20250", ano: "2019" },
            "CR-00108": { chassi: "HBZBW20EEEAE06253", fabricante: "CASE", modelo: "W20E CAB", ano: "2013" },
            "CR-00120": { chassi: "KMTWA105TJBB20703", fabricante: "KOMATSU", modelo: "WA 200-6", ano: "2018" },
            "CR-00122": { chassi: "KMTWA105CJBB20612", fabricante: "KOMATSU", modelo: "WA200-6", ano: "2018" },
            "EA-00001": { chassi: "3656", fabricante: "CMV", modelo: "DA 3660", ano: "2006" },
            "EM-00008": { chassi: "A3AD03880", fabricante: "HENRY", modelo: "CPYD50", ano: "2015" },
            "ES-00097": { chassi: "HBZN220CCHAA02529 Nr S√©rie 210CL200098", fabricante: "CASE", modelo: "CX220C", ano: "2017" },
            "ES-00101": { chassi: "NHAA02468", fabricante: "CASE", modelo: "CX220C", ano: "2017" },
            "ES-00109": { chassi: "1F9210GXEJD520986", fabricante: "JOHN DEERE", modelo: "210G", ano: "2018" },
            "ES-00118": { chassi: "CAT0320DKA8F03183", fabricante: "CATERPILLAR", modelo: "320 DL", ano: "2008" },
            "EX-00014": { chassi: "EHD-1807001", fabricante: "IMB", modelo: "2000HD", ano: "2018" },
            "EX-00016": { chassi: "EMMA1904006", fabricante: "IMB", modelo: "IBM 900G MASTER", ano: "2019" },
            "EX-NC-SGA-EX-SERIE-08011": { chassi: "EMST.2008011", fabricante: "IMB", modelo: "900 G", ano: "2020" },
            "GD-00136": { chassi: "60998474001004", fabricante: "BALDAN", modelo: "GTCR DE 16C/DSC REC 32", ano: "2017" },
            "GD-00139": { chassi: "11983901", fabricante: "WV", modelo: "GAICR 20X26 20d x 26pol", ano: "2018" },
            "GD-00140": { chassi: "11983902", fabricante: "WV", modelo: "GAICR 20X26 20d x 26pol", ano: "2018" },
            "GD-00141": { chassi: "11983903", fabricante: "WV", modelo: "GAICR 20X26 20d x 26pol", ano: "2018" },
            "GD-00157": { chassi: "0102060065-9680", fabricante: "MARCHESAN", modelo: "GAPCR S-0603", ano: "2019" },
            "GD-00158": { chassi: "0102060065-9681", fabricante: "MARCHESAN", modelo: "GAPCR S-0603", ano: "2019" },
            "GD-NC-GD-SGA-NS-01001": { chassi: "1050996001001", fabricante: "BALDAN", modelo: "CRI -DE 24 / DSC REC 28", ano: "2022" },
            "GE-00199": { chassi: "PW935639", fabricante: "GERAPOWER BRASIL", modelo: "400KVA - CUMMINS NTA855G1B GF3-500", ano: "2018" },
            "GE-00211": { chassi: "MOTOR: B506821T 10P0026", fabricante: "HEIMER", modelo: "ATED27/19 (100KVA)", ano: "2007" },
            "GE-00213": { chassi: "N√£o possui", fabricante: "GERAPOWER BRASIL", modelo: "GB5000", ano: "2019" },
            "GE-00221": { chassi: "A15T033686", fabricante: "POWER GENERATION", modelo: "C185D6 231 KVA", ano: "2015" },
            "GE-NC-SGA-GE-1001": { chassi: "1536401001", fabricante: "MAXITRUST", modelo: "MX508SWABAS3", ano: "2022" },
            "KCV-00122": { chassi: "WHCOH221NH0000018", fabricante: "HAMM-WIRTGEM GROUP", modelo: "3411P", ano: "2017" },
            "KCV-00128": { chassi: "VCE0S105VJ0707263", fabricante: "VOLVO", modelo: "SD105", ano: "2018" },
            "KCV-00129": { chassi: "VCE0S105CJ0707262", fabricante: "VOLVO", modelo: "SD105", ano: "2018" },
            "KCV-00131": { chassi: "WHCOH221NH0000022", fabricante: "HAMM-WIRTGEM GROUP", modelo: "3411P", ano: "2017" },
            "KCV-00179": { chassi: "10000181CNB007529", fabricante: "DYNAPAC", modelo: "CA30PD", ano: "2022" },
            "KCV-00180": { chassi: "10000181HNB007530", fabricante: "DYNAPAC", modelo: "CA30PD", ano: "2022" },
            "KCV-NOVO-CHASSI-7667": { chassi: "10000181VNB07667", fabricante: "DYNAPAC", modelo: "CA30PD", ano: "2022" },
            "KCV-NOVO-CHASSI-7763": { chassi: "10000181JNB007763", fabricante: "DYNAPAC", modelo: "CA30PD", ano: "2022" },
            "KCV-NOVO-CHASSI-7979": { chassi: "1000018LPB007979", fabricante: "DYNAPAC", modelo: "CA30PD", ano: "2021" },
            "KLT-00010": { chassi: "40411101401A", fabricante: "COMPACT POWER", modelo: "RWYL51C", ano: "2017" },
            "KLT-00011": { chassi: "WHCOH245NJ0000037", fabricante: "HAMM-WIRTGEM GROUP", modelo: "HD90", ano: "2018" },
            "KLT-00012": { chassi: "WHCOH245NJ0000033", fabricante: "HAMM-WIRTGEM GROUP", modelo: "HD90", ano: "2018" },
            "KLV-00102": { chassi: "10000108CJB005659", fabricante: "DYNAPAC", modelo: "CA250", ano: "2018" },
            "KM-00100": { chassi: "EQP: CPM4L18012513; MOTOR: T2180018010078103", fabricante: "MATSUYAMA", modelo: "CPM4L", ano: "2018" },
            "KP-00066": { chassi: "CAT0CW34P3G400157", fabricante: "CATERPILLAR", modelo: "CW34", ano: "2018" },
            "KP-00067": { chassi: "CAT0CW34J3G400159", fabricante: "CATERPILLAR", modelo: "CW34", ano: "2018" },
            "KP-00069": { chassi: "CAT0CW34P3G400160", fabricante: "CATERPILLAR", modelo: "CW34", ano: "2018" },
            "MC-00023": { chassi: "JAFSV185466655", fabricante: "CASE", modelo: "SV185", ano: "2013" },
            "MN-00003": { chassi: "CAT0140HCCA02771", fabricante: "CATERPILLAR", modelo: "140 H", ano: "2006" },
            "MN-00138": { chassi: "CAT0140KCJPA01833", fabricante: "CATERPILLAR", modelo: "140K", ano: "2013" },
            "MN-00149": { chassi: "CAT0120KCJAP07005", fabricante: "CATERPILLAR", modelo: "120K", ano: "2017" },
            "MN-00150": { chassi: "CAT0120KCJAP07004", fabricante: "CATERPILLAR", modelo: "120K", ano: "2017" },
            "MN-00151": { chassi: "CAT0120KCJAP07012", fabricante: "CATERPILLAR", modelo: "120K", ano: "2017" },
            "MN-NC-SGA-MN-CHASSI-0301": { chassi: "1BZ670GAKND000301", fabricante: "JOHN DEERE", modelo: "670G", ano: "2022" },
            "PVA-00049": { chassi: "CP540006", fabricante: "CIBER", modelo: "AF5000", ano: "2018" },
            "PVA-00050": { chassi: "CP540007", fabricante: "CIBER", modelo: "AF5000", ano: "2018" },
            "RE-00094": { chassi: "1BZ310KXEGC000866", fabricante: "JOHN DEERE", modelo: "310K", ano: "2016" },
            "RE-00101": { chassi: "CAT0420FCLBS01096", fabricante: "CATERPILLAR", modelo: "420F2", ano: "2017" },
            "RE-00102": { chassi: "CAT0420FKLBS01099", fabricante: "CATERPILLAR", modelo: "420F2", ano: "2017" },
            "RM-00004": { chassi: "03WR0365", fabricante: "WIRTGEN", modelo: "WR2000", ano: "2010" },
            "TA-00121": { chassi: "R004404A", fabricante: "AGRALE", modelo: "BX 6.150", ano: "2010" },
            "TA-00158": { chassi: "1BM6150JJHD000433", fabricante: "JOHN DEERE", modelo: "6150J MAR-I", ano: "2017" },
            "TA-00165": { chassi: "W18456858", fabricante: "VALTRA", modelo: "BH184 4X4", ano: "2019" },
            "TA-00166": { chassi: "W18456859", fabricante: "VALTRA", modelo: "BH184 4X4", ano: "2019" },
            "TA-NC-SGA-TA-40146": { chassi: "1BM6150JCND640146", fabricante: "JOHN DEERE", modelo: "6150J", ano: "2022" },
            "TE-00086": { chassi: "BJG07278 CAT00D6NHCCK00981", fabricante: "CATERPILLAR", modelo: "D6N", ano: "2008" },
            "TE-00130": { chassi: "GCT02004 2692038", fabricante: "CATERPILLAR", modelo: "D6T", ano: "2013" },
            "TE-00134": { chassi: "HBZN150BCFAC00625", fabricante: "NEW HOLLAND", modelo: "D150B", ano: "2015" },
            "TI-00056": { chassi: "PW935217", fabricante: "GERAPOWER BRASIL", modelo: "RWZM41C", ano: "2019" },
            "TI-00057": { chassi: "PW935218", fabricante: "GERAPOWER BRASIL", modelo: "RWZM41C", ano: "2019" },
            "UA-00038": { chassi: "9A98RNC13HPDM7132 n¬∫ serie c1120130", fabricante: "CIBER", modelo: "BR", ano: "2018" },
            "VM-NC-SGA-VM-FKT-01": { chassi: "10107/18", fabricante: "J COLOMBO", modelo: "TANGARA", ano: "2018" },
            "AB-00010 (6¬∫ BEC)": { chassi: "201112052", fabricante: "Hank", modelo: "HK4.0", ano: "2020" },
            "AB-00012 (6¬∫ BEC)": { chassi: "BX14M00528", fabricante: "FIORI", modelo: "DBX35", ano: "2022" },
            "AB-00011 (5¬∫ BEC)": { chassi: "BX14M00550", fabricante: "FIORI", modelo: "BX14M0050", ano: "2021" },
            "ES-00004 (6¬∫ BEC)": { chassi: "N6AAOLL89", fabricante: "NEW HOLLAND", modelo: "E 215 LC", ano: "2007" },
            "ES-00125 (6¬∫ BEC)": { chassi: "2797699", fabricante: "JCB", modelo: "JS22OLC", ano: "2020" },
            "ES-NC-SGA-ES-CHASSI-S0RJS21CCP3161925-21¬∫ Cia-E-Cnst": { chassi: "S0RJS21CCP3161925", fabricante: "JCB", modelo: "JS210SC", ano: "2023" },
            "ES-00121 (5¬∫ BEC)": { chassi: "NKAA03108", fabricante: "NEW HOLLAND", modelo: "E215.C EVO", ano: "2019" },
            "ES-00130 (5¬∫ BEC)": { chassi: "SORJS21CHM3089738", fabricante: "JCB", modelo: "SORJS21", ano: "2021" },
            "EX-00018 (5¬∫ BEC)": { chassi: "FMO 191003", fabricante: "IBM", modelo: "900G", ano: "2019" },
            "GD-00174 (6¬∫ BEC)": { chassi: "GRI00334/20", fabricante: "RHOMA", modelo: "ICR 20X26", ano: "2020" },
            "GD-00176 (6¬∫ BEC)": { chassi: "GRI00337/20", fabricante: "RHOMA", modelo: "ICR 20X26", ano: "2020" },
            "NC-SGA-GD-01-6¬™CIAENGCMB": { chassi: "-", fabricante: "KLR", modelo: "GAC270 1828", ano: "2019" },
            "GD-00179 (5¬∫ BEC)": { chassi: "-", fabricante: "PICCIN", modelo: "GAICR 24 X 26", ano: "2020" },
            "GD-00177 (5¬∫ BEC)": { chassi: "-", fabricante: "PICCIN", modelo: "GAICR 24 X 26", ano: "2020" },
            "KCV-00130 (6¬∫ BEC)": { chassi: "VCE0S105HJ0707249", fabricante: "VOLVO", modelo: "SD105", ano: "2018" },
            "KCV-00132 (6¬∫ BEC)": { chassi: "VCE0S105HJ0707242", fabricante: "VOLVO", modelo: "SD105", ano: "2018" },
            "KCV-00133 (6¬∫ BEC)": { chassi: "VCE0S105PJ0707244", fabricante: "VOLVO", modelo: "SD 105", ano: "2018" },
            "KCV-00175 (6¬∫ BEC)": { chassi: "GP500187", fabricante: "CATERPILLAR", modelo: "CP54B", ano: "2020" },
            "KCV-00176 (6¬∫ BEC)": { chassi: "XUGO1231CNAE00578", fabricante: "XCMG", modelo: "XS123PDBR", ano: "2021" },
            "KCV-00191 (6¬∫ BEC)": { chassi: "71", fabricante: "ROMANELLI", modelo: "VAP70", ano: "2023" },
            "KCV-00193 (5¬∫ BEC)": { chassi: "H00422526", fabricante: "JCB", modelo: "JCB116D", ano: "2024" },
            "KCV-00194 (5¬∫ BEC)": { chassi: "H00429287", fabricante: "JCB", modelo: "JCB116D", ano: "2024" },
            "KCV-00171 (5¬∫ BEC)": { chassi: "LDA00150NK0100110", fabricante: "MULLER", modelo: "VAP70PT", ano: "2019" },
            "MN-00156 (6¬∫ BEC)": { chassi: "HBZN0140KJAF07407 / NJAF07407", fabricante: "NEW HOLLAND", modelo: "RG140B", ano: "2018" },
            "MN-00166 (6¬∫ BEC)": { chassi: "HBZN0140KJAF07409", fabricante: "NEW HOLLAND", modelo: "RG140B", ano: "2018" },
            "MN-00167 (5¬∫ BEC)": { chassi: "NKAF07716", fabricante: "NEW HOLLAND", modelo: "RG-140B", ano: "2019" },
            "RE-00121 (6¬∫ BEC)": { chassi: "S0R3CXTTVL2935818", fabricante: "JCB", modelo: "3CXB14CM2CM", ano: "2018" },
            "RE-00123 (6¬∫ BEC)": { chassi: "S0R3CXTTCM3088060", fabricante: "JCB", modelo: "3CXB14CM2CM", ano: "2021" },
            "TA-00071 (6¬∫ BEC)": { chassi: "27CC29237 / TM35R400876", fabricante: "NEW HOLLAND", modelo: "TM135", ano: "2007" },
            "TA-00161 (6¬∫ BEC)": { chassi: "HCCZ7175TECV55923 / T7175SC10865", fabricante: "NEW HOLLAND", modelo: "T7.175", ano: "2017" },
            "TA-00162 (6¬∫ BEC)": { chassi: "HCCZ7175TECV55940 / T7175SC10866", fabricante: "NEW HOLLAND", modelo: "T7.175", ano: "2017" },
            "TA-NC-SGA-TA-707-6¬™CIAENGCMB": { chassi: "HCCZTL80VKCJ94707", fabricante: "NEW HOLLAND", modelo: "TL5.80", ano: "2019" },
            "TA-00139 (5¬∫ BEC)": { chassi: "239021292", fabricante: "AGRALE", modelo: "BX - 6150", ano: "2014" },
            "TA-00130 (5¬∫ BEC)": { chassi: "2390212792", fabricante: "AGRALE", modelo: "BX - 6150", ano: "2014" },
            "NC-SGA-TE-306-6¬™CIAENGCMB": { chassi: "P5T00306", fabricante: "CATERPILLAR", modelo: "D6N XL", ano: "2019" },
            "TEA-00009-2¬∫BFV": { chassi: "7072410022", fabricante: "TEREX", modelo: "CAP", ano: "2007" },
            "CB-00633 (6¬∫ BEC)": { chassi: "953658268MR120105", fabricante: "VW", modelo: "VW 26 280 CRM 6X4", ano: "2020" },
            "CB-00630 (6¬∫ BEC)": { chassi: "953658263MR120075", fabricante: "VW", modelo: "VW 26 280 CRM 6X4", ano: "2020" },
            "CB-00635 (6¬∫ BEC)": { chassi: "953658260MR120101", fabricante: "VW", modelo: "VW 26 280 CRM 6X4", ano: "2020" },
            "CB-00632 (6¬∫ BEC)": { chassi: "953658268MR120024", fabricante: "VW", modelo: "VW 26 280 CRM 6X4", ano: "2020" },
            "CB-00634 (6¬∫ BEC)": { chassi: "953658266MR120118", fabricante: "VW", modelo: "VW 26 280 CRM 6X4", ano: "2020" },
            "CB-00691 (6¬∫ BEC)": { chassi: "93KK0Y1DXRE193955", fabricante: "VOLVO", modelo: "VM 290", ano: "2023" },
            "CB-00631 (6¬∫ BEC)": { chassi: "953658260MR120079", fabricante: "VW", modelo: "VW 26 280 CRM 6X4", ano: "2020" },
            "CB-NC-SGA-CB-CHASSI-58116-34¬∫BIS": { chassi: "9533172S0DR358116", fabricante: "VOLKSWAGEN", modelo: "15180E3W", ano: "2013" },
            "CB-00518 (5¬∫ BEC)": { chassi: "9BM693388EB967190", fabricante: "MERCEDEZ BENZ", modelo: "ATRON 2726K/36 6X4", ano: "2014" },
            "CB-00638 (5¬∫ BEC)": { chassi: "9BM958170LB202608", fabricante: "MERCEDEZ BENZ", modelo: "ATEGO2730K/36", ano: "2020" },
            "CB-00645 (5¬∫ BEC)": { chassi: "9BM958170LB202641", fabricante: "MERCEDEZ BENZ", modelo: "ATEGO2730K/36", ano: "2020" },
            "CB-00641 (5¬∫ BEC)": { chassi: "9BM958170LB202599", fabricante: "MERCEDEZ BENZ", modelo: "ATEGO2730K/36", ano: "2020" },
            "CB-00646 (5¬∫ BEC)": { chassi: "9BM958170LB201357", fabricante: "MERCEDEZ BENZ", modelo: "ATEGO2730K/36", ano: "2020" },
            "CB-00675 (5¬∫ BEC)": { chassi: "9BM958174KB125891", fabricante: "MERCEDEZ BENZ", modelo: "ATEGO2730/48", ano: "2019" },
            "CB-00676 (5¬∫ BEC)": { chassi: "9BM958174KB126264", fabricante: "MERCEDEZ BENZ", modelo: "2730/48", ano: "2019" },
            "CB-00674 (5¬∫ BEC)": { chassi: "-", fabricante: "MERCEDEZ BENZ", modelo: "ATEGO 2730", ano: "2019" },
            "CG-00064 (6¬∫ BEC)": { chassi: "953658263GR607667", fabricante: "VOLKSWAGEN", modelo: "26 280", ano: "2016" },
            "CL-00066 (6¬∫ BEC)": { chassi: "9BFZEANE6DBS23016", fabricante: "FORD", modelo: "CARGO 2629", ano: "2012" },
            "CPD-00384 (6¬∫ BEC)": { chassi: "8AJFY22G0F8028091", fabricante: "TOYOTA", modelo: "HILUX CD 4X4 STD", ano: "2015" },
            "CQT-00167 (6¬∫ BEC)": { chassi: "9533172S9DR345266", fabricante: "VW", modelo: "WORKER 15.210", ano: "2013" },
            "CQT-00151 (6¬∫ BEC)": { chassi: "9BM958078DB911530", fabricante: "MERCEDEZ BENZ", modelo: "ATEGO 1725/42", ano: "2013" },
            "CTA-00150 (6¬∫ BEC)": { chassi: "9BFZEANE2DBS22994", fabricante: "FORD", modelo: "CARGO 2629", ano: "2012" },
            "CTA-00148 (6¬∫ BEC)": { chassi: "9BFZEANEXDBS18949", fabricante: "FORD", modelo: "CARGO 2629", ano: "2012" },
            "CTA-NC-SGA-CTA-CHASSI-27388-34¬∫BIS": { chassi: "9BFZEANE8DBS27388", fabricante: "FORD", modelo: "FORD CARGO 2629 6X4", ano: "2012" },
            "CTA-NC-SGA-CTA-CHASSI-16718-34¬∫BIS": { chassi: "9533B82UXDR316718", fabricante: "VOLKSWAGEN", modelo: "26260E", ano: "2013" },
            "CTA-00126 (5¬∫ BEC)": { chassi: "9533B82U3DR316592", fabricante: "VOLKSWAGEM", modelo: "26.260E", ano: "2012" },
            "NC-SGA-PB-01-CHASSI 8003-6¬™CIAENGCMB": { chassi: "9A9SRCT4EMPF08003", fabricante: "TEIXEIRA", modelo: "SR CT 4E", ano: "2021" },
            "NC-SGA-RTA-CIB-314-COMARA": { chassi: "-", fabricante: "NAO INDENTIFICADO", modelo: "TANQUE 30.000 l", ano: "NAO INDENTIFICADO" },
            "NC-SGA-RTA-CIB-320-1978-COMARA": { chassi: "-", fabricante: "NAO INDENTIFICADO", modelo: "TANQUE 30.000 l", ano: "1978" },
            "NC-SGA-RTA-CIF-306-1983-COMARA": { chassi: "-", fabricante: "FNV-FRUEHAUF", modelo: "TANQUE 30.000 l", ano: "1983" }

        };

        let itensAdicionados = [];
        let todosOsPrefixos = [];
        let opcaoImagemAtiva = 'colar';

        // Carregar os dados quando a p√°gina carregar
        window.onload = function () {
            carregarPrefixos();
            definirDataAtual();
            configurarEventosImagem();
        };

        function definirDataAtual() {
            const hoje = new Date();
            const dataFormatada = hoje.toISOString().split('T')[0];
            document.getElementById('dataSolicitacao').value = dataFormatada;
        }

        function carregarPrefixos() {
            const select = document.getElementById('prefixo');
            todosOsPrefixos = Object.keys(veiculos).sort();

            select.innerHTML = '<option value="">Selecione o Prefixo</option>';

            todosOsPrefixos.forEach(prefixo => {
                const option = document.createElement('option');
                option.value = prefixo;
                option.textContent = prefixo;
                select.appendChild(option);
            });
        }

        function filtrarPrefixos() {
            const searchTerm = document.getElementById('searchPrefixo').value.toLowerCase();
            const select = document.getElementById('prefixo');

            select.innerHTML = '<option value="">Selecione o Prefixo</option>';

            const prefixosFiltrados = todosOsPrefixos.filter(prefixo =>
                prefixo.toLowerCase().includes(searchTerm)
            );

            prefixosFiltrados.forEach(prefixo => {
                const option = document.createElement('option');
                option.value = prefixo;
                option.textContent = prefixo;
                select.appendChild(option);
            });
        }

        function carregarDadosVeiculo() {
            const prefixoSelecionado = document.getElementById('prefixo').value;

            if (prefixoSelecionado && veiculos[prefixoSelecionado]) {
                const veiculo = veiculos[prefixoSelecionado];
                document.getElementById('marca').value = veiculo.fabricante;
                document.getElementById('modelo').value = veiculo.modelo;
                document.getElementById('ano').value = veiculo.ano;
                document.getElementById('chassi').value = veiculo.chassi;
            } else {
                document.getElementById('marca').value = '';
                document.getElementById('modelo').value = '';
                document.getElementById('ano').value = '';
                document.getElementById('chassi').value = '';
            }
        }

        function alternarOpcaoImagem(opcao, event) {
            opcaoImagemAtiva = opcao;

            // Atualizar apar√™ncia dos bot√µes
            document.querySelectorAll('.image-option').forEach(el => el.classList.remove('active'));
            if (event && event.currentTarget) {
                event.currentTarget.classList.add('active');
            }

            // Mostrar/esconder elementos
            if (opcao === 'colar') {
                document.getElementById('pasteArea').classList.remove('hidden');
                document.getElementById('imagem').classList.add('hidden');
            } else {
                document.getElementById('pasteArea').classList.add('hidden');
                document.getElementById('imagem').classList.remove('hidden');
            }
        }

        function configurarEventosImagem() {
            const pasteArea = document.getElementById('pasteArea');

            // Evento de colar
            pasteArea.addEventListener('paste', function (e) {
                e.preventDefault();
                const items = e.clipboardData.items;

                for (let i = 0; i < items.length; i++) {
                    if (items[i].type.indexOf('image') !== -1) {
                        const blob = items[i].getAsFile();
                        const reader = new FileReader();
                        reader.onload = function (event) {
                            mostrarPreviewImagem(event.target.result);
                        };
                        reader.readAsDataURL(blob);
                        break;
                    }
                }
            });

            // Eventos de drag and drop
            pasteArea.addEventListener('dragover', function (e) {
                e.preventDefault();
                pasteArea.classList.add('dragover');
            });

            pasteArea.addEventListener('dragleave', function (e) {
                e.preventDefault();
                pasteArea.classList.remove('dragover');
            });

            pasteArea.addEventListener('drop', function (e) {
                e.preventDefault();
                pasteArea.classList.remove('dragover');

                const files = e.dataTransfer.files;
                if (files.length > 0 && files[0].type.indexOf('image') !== -1) {
                    const reader = new FileReader();
                    reader.onload = function (event) {
                        mostrarPreviewImagem(event.target.result);
                    };
                    reader.readAsDataURL(files[0]);
                }
            });

            // Tornar √°rea foc√°vel para eventos de teclado
            pasteArea.tabIndex = 0;
        }

        function previewImagem() {
            const input = document.getElementById('imagem');

            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    mostrarPreviewImagem(e.target.result);
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        function mostrarPreviewImagem(src) {
            const preview = document.getElementById('imagemPreview');
            preview.src = src;
            preview.classList.remove('hidden');
        }

        function mostrarAlerta(tipo, mensagem) {
            const container = document.getElementById('alertContainer');
            const alerta = document.createElement('div');
            alerta.className = `alert alert-${tipo}`;
            alerta.textContent = mensagem;

            container.innerHTML = '';
            container.appendChild(alerta);

            setTimeout(() => {
                container.innerHTML = '';
            }, 5000);
        }

        function adicionarItem() {
            const referencia = document.getElementById('referencia').value.trim();
            const descricao = document.getElementById('descricao').value.trim();
            const link = document.getElementById('link').value.trim();
            const quantidadeStr = document.getElementById('quantidade').value.trim();
            const unidade = document.getElementById('unidade').value;
            const preview = document.getElementById('imagemPreview');

            if (!referencia || !descricao) {
                mostrarAlerta('error', 'Por favor, preencha os campos obrigat√≥rios (Refer√™ncia e Descri√ß√£o).');
                return;
            }

            const quantidade = Number(quantidadeStr);
            if (!quantidade || quantidade < 1) {
                mostrarAlerta('error', 'Por favor, informe uma quantidade v√°lida (m√≠nimo 1).');
                return;
            }

            const item = {
                id: Date.now(),
                referencia,
                descricao,
                link: link || 'N√£o informado',
                quantidade,
                unidade,
                imagem: preview.classList.contains('hidden') ? null : preview.src
            };

            itensAdicionados.push(item);
            atualizarListaItens();
            limparFormularioItens();
            mostrarAlerta('success', 'Item adicionado com sucesso!');
        }

        function atualizarListaItens() {
            const container = document.getElementById('listaItens');

            if (itensAdicionados.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #7f8c8d; font-style: italic;">Nenhum item adicionado ainda.</p>';
                return;
            }

            container.innerHTML = '';

            itensAdicionados.forEach((item, index) => {
                const itemCard = document.createElement('div');
                itemCard.className = 'item-card';

                itemCard.innerHTML = `
                    <div class="item-header">
                        <span class="item-number">Item ${index + 1}</span>
                        <button class="btn btn-danger" onclick="removerItem(${item.id})">üóëÔ∏è Remover</button>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                        <div>
                            <strong>Qtd.:</strong><br>
                            ${item.quantidade}
                        </div>
                        <div>
                            <strong>Unid.:</strong><br>
                            ${item.unidade}
                        </div>
                        <div>
                            <strong>Refer√™ncia:</strong><br>
                            ${item.referencia}
                        </div>
                        <div>
                            <strong>Descri√ß√£o:</strong><br>
                            ${item.descricao}
                        </div>
                        <div>
                            <strong>Link:</strong><br>
                            ${item.link !== 'N√£o informado' ? `<a href="${item.link}" target="_blank" rel="noopener noreferrer">Ver Link</a>` : 'N√£o informado'}
                        </div>
                        ${item.imagem ? `<div><strong>Imagem:</strong><br><img src="${item.imagem}" style="max-width: 150px; max-height: 150px; border-radius: 5px;" alt="Imagem da pe√ßa ${item.referencia}"></div>` : ''}
                    </div>
                `;

                container.appendChild(itemCard);
            });
        }

        function removerItem(itemId) {
            if (confirm('Tem certeza que deseja remover este item?')) {
                itensAdicionados = itensAdicionados.filter(item => item.id !== itemId);
                atualizarListaItens();
                mostrarAlerta('success', 'Item removido com sucesso!');
            }
        }

        function limparFormularioItens() {
            document.getElementById('referencia').value = '';
            document.getElementById('descricao').value = '';
            document.getElementById('link').value = '';
            document.getElementById('quantidade').value = '1';
            document.getElementById('unidade').value = 'UND';
            document.getElementById('imagem').value = '';
            document.getElementById('imagemPreview').classList.add('hidden');
        }
        

        function gerarRelatorio() {
            const solicitanteInput = document.getElementById('solicitante');
            const solicitante = solicitanteInput.value.trim().toUpperCase(); // converte para mai√∫sculas
            solicitanteInput.value = solicitante; // atualiza o campo com mai√∫sculas
            const prefixo = document.getElementById('prefixo').value;

            if (!solicitante) {
                mostrarAlerta('error', 'Por favor, preencha o nome do solicitante.');
                return;
            }

            if (!prefixo) {
                mostrarAlerta('error', 'Por favor, selecione uma viatura/equipamento.');
                return;
            }

            if (itensAdicionados.length === 0) {
                mostrarAlerta('error', 'Por favor, adicione pelo menos um item.');
                return;
            }

            // Preencher dados do relat√≥rio
            document.getElementById('relSolicitante').textContent = solicitante;
            document.getElementById('relDataSolicitacao').textContent = document.getElementById('dataSolicitacao').value
                ? new Date(document.getElementById('dataSolicitacao').value).toLocaleDateString('pt-BR')
                : new Date().toLocaleDateString('pt-BR');
            document.getElementById('relPrefixo').textContent = prefixo;
            document.getElementById('relMarca').textContent = document.getElementById('marca').value;
            document.getElementById('relModelo').textContent = document.getElementById('modelo').value;
            document.getElementById('relAno').textContent = document.getElementById('ano').value;
            document.getElementById('relChassi').textContent = document.getElementById('chassi').value;

            // Preencher tabela de itens
            const tabelaItens = document.getElementById('tabelaItensSimples');
            tabelaItens.innerHTML = '';

            itensAdicionados.forEach((item, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${item.quantidade}</td>
                    <td>${item.unidade}</td>
                    <td>${item.referencia}</td>
                    <td>${item.descricao}</td>
                    <td>${item.link !== 'N√£o informado' ? `<a href="${item.link}" target="_blank" rel="noopener noreferrer">Ver Link</a>` : 'N√£o informado'}</td>
                    <td>${item.imagem ? `<img src="${item.imagem}" alt="Imagem da pe√ßa ${item.referencia}">` : 'Sem imagem'}</td>
                `;
                tabelaItens.appendChild(row);
            });

            // Mostrar relat√≥rio
            document.querySelector('.main-content').classList.add('hidden');
            document.getElementById('relatorio').classList.remove('hidden');
        }

        function voltarFormulario() {
            document.querySelector('.main-content').classList.remove('hidden');
            document.getElementById('relatorio').classList.add('hidden');
        }

        function imprimirRelatorio() {
            window.print();
        }

        function limparFormulario() {
            if (confirm('Tem certeza que deseja limpar todos os dados? Esta a√ß√£o n√£o pode ser desfeita.')) {
                document.getElementById('solicitante').value = '';
                definirDataAtual();
                document.getElementById('prefixo').value = '';
                carregarDadosVeiculo();
                limparFormularioItens();
                itensAdicionados = [];
                atualizarListaItens();
                document.getElementById('alertContainer').innerHTML = '';
                mostrarAlerta('success', 'Formul√°rio limpo com sucesso!');
            }
        }
        
        async function gerarPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('p', 'pt', 'a4');
            const relatorio = document.getElementById('relatorio');
          // Captura o conte√∫do do relat√≥rio como imagem
            const canvas = await html2canvas(relatorio, { scale: 2 });
            const imgData = canvas.toDataURL('image/png');
            const imgProps = doc.getImageProperties(imgData);
            const pdfWidth = doc.internal.pageSize.getWidth();
            const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;
            doc.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
            doc.save('relatorio.pdf');
        }

        
</script>
</body>
</html>
